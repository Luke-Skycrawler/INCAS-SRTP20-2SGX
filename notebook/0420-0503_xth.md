# 0420 - 0503 笔记

[toc]

## RSA算法

### 产生公私钥对

1. 随机选择两个不相等的质数$p$、$q$

2. 计算乘积$n=p\times q$：密钥的长度。实际中一般为1024或2048位

3. 计算$n$的欧拉函数$\varphi(n)$
   $$
   \varphi(n)=(p-1)(q-1)
   $$
   

4. 随机选择一个整数$e$：用来加密的数
   需要满足$1<e<\varphi(n)$，且$e$与$\varphi(n)$**互质**

5. 计算$e$对于$\varphi(n)$的乘法逆元$d$：用来解密的数
   $$
   e\cdot d\equiv 1\ mod\ \varphi(n)
   $$

6. 将$(n,e)$封装为公钥，$(n,d)$封装为私钥

### RSA加密 -- 使用公钥

对明文进行比特串分组，使得每个分组$m$对应的十进制数小于$n$，再依次对每个分组$m$进行一次加密。所有分组的密文构成的序列就是原始消息的加密结果。对于每一个分组$m$的一次加密得到的密文$c$为：
$$
c=m^e\ mod\ n
$$

+ 注意到$0\le m,c<n$

### RSA解密 -- 使用私钥

对于密文$0\le m,c<n$，解密算法：
$$
m=c^d\ mod\ n
$$

### RSA数字签名&验证

#### 签名

对于一个消息$m$，利用私钥中的$d$进行签名，得到$sign$为：
$$
sign\equiv m^d\ mod\ n
$$

#### 验证

进行验证时，先计算
$$
m_{calculate}\equiv sign^e\ mod\ n
$$
将$m_{calculate}$与已知的公钥中的$m$进行对比，如果一致，则$sign$是$m$的有效签名

### RSA公开密钥密码体制 -- 非对称密码

所谓的公开密钥密码体制就是使用不同的加密密钥与解密密钥，是一种“由已知加密密钥推导出解密密钥在计算上是不可行的”密码体制。

在公开密钥密码体制中，加密密钥（即公开密钥）PK是公开信息，而解密密钥（即秘密密钥）SK是需要保密的。加密算法E和解密算法D也都是公开的。虽然解密密钥SK是由公开密钥PK决定的，但却不能根据PK计算出SK。